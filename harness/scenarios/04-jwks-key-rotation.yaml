id: jwks-key-rotation
priority: p1
objective: 署名鍵ローテーションAPI実行後に JWKS 公開が整合すること
preconditions:
  - `OIDC_ENABLE_SIGNING_KEY_ROTATION_API=true`
  - `OIDC_SIGNING_KEY_ROTATION_TOKEN` が設定済み
steps:
  - `/oauth2/admin/rotate-signing-key` に Bearer token 付きで POST
  - JWKS を取得
  - active kid の更新と grace window を確認
expect:
  - 不正 token は `401` / `unauthorized` で拒否される
  - ローテーション成功時は `200` と新 `kid` が返る
  - JWKS の先頭 key (`keys[0].kid`) が新 `kid` と一致する
  - 直前の active `kid` は grace window 中に保持される
  - kid 衝突がない
  - 公開鍵数は上限（2）を超えない
